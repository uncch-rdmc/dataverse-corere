<div class="cblue" id="file_table_holder">
    <br>
    <h2>Files</h2>
    <table id="file_table" class="datatable table table-striped table-bordered filetable" cellspacing="0" width="100%">
        <thead>
            <tr>
                <th></th>
                <th>Path</th>
                <th>Name</th>
                {% if obj_type == "submission" %}<th></th>{% endif %}
            </tr>
        </thead>
    </table>
</div>

{% load static %}
<!--NEXT: we need to dynamically serve this table depending on manuscript/submission and read/write-->
<script type="text/javascript" src="{% static 'file_datatable/file_datatable.js' %}"></script>
<script type="text/javascript">
    $(document).ready(function() {
        {% if obj_type == "submission" %}
        config = create_file_table_config("/submission/{{obj_id}}/file_table/", {{read_only|lower}})
        //Do we want to define the icon column somewhere else? Or will we always call this code anyways?
        fourth_column =                 {
                    data: 'newness',
                    render: function(data,type,row,meta){
                        encoded = encodeURIComponent(row[0]+row[1])
                        button = '<td><img style="height:30px; width:30px" src="../newfilecheck/?file_path='+encoded+'"/></td>'

                        return button;
                    }
                },
        config['columns'].push(fourth_column)
        fourth_column_def = { "width": "33px", "targets": 3 }
        config['columnDefs'].push(fourth_column_def)
        {% else %}
        config = create_file_table_config("/manuscript/{{obj_id}}/file_table/", {{read_only|lower}})
        {% endif %}
        $('#file_table').DataTable(config)
    } );
</script>
<!-- steps: 
    - get base datatable options
    - extend() them with new options (programatically from template tags?)
    - instantiate datatable off our options
    - pass our datatable to predefined listeners to attach them

    So my big question is how to turn OFF nested pieces of functionality. 
    Extend merges at the highest level but then either overrides or recrusively merges.
    The nested parameters (button, columns) we'd want to disable aren't named... so we can't disable them without disabling everything?
    ... We could have base parameters and then add the columns and buttons seperately 
        ... At this point maybe we should just write a function that does all this
            ... function create_file_table_config(readonly, )
        ... This connects to another issue which is what code do I want to live in my separate app, and what to live outside
            ... I think the compare files option should be outside. 
                ... Which is easy, we can just push the extra column
            ... 
-->